<script>
    document.addEventListener("DOMContentLoaded", function() {
        let quickEditEnabled = false
        let copyLinksEnabled = false

        // quick edit

        const editIcons = document.querySelectorAll('.edit-icon');
        const qEditToggle = document.querySelector('#qEditToggle');
        let editBtnVisible = false;

        qEditToggle.addEventListener('click', () => {
            if (editBtnVisible == true) {

                editBtnVisible = false;
                editIcons.forEach(icon => {
                    icon.style.display = "none"
                })
            } else {
                editBtnVisible = true;
                editIcons.forEach(icon => {
                    icon.style.display = "block"
                    icon.addEventListener('click', () => {
                        // console.log(this);
                        const id = icon.getAttribute('data-id');
                        const content = icon.getAttribute('data-content');
                        const fieldUncap = icon.getAttribute('data-field')
                        const editField = fieldUncap.charAt(0).toUpperCase() + fieldUncap.slice(1)


                        openEditModal(id, content, editField);
                    });
                })
            }
        })






    });

    function openEditModal(id, content, editField) {
        // populate modal content
        const editModalContent = `
        <label for="rj-modal" class="rj-modal-background"></label>
        <div class="rj-modal">
            <div class="rj-modal-header">
                <h3>Edit ${editField} - ID : ${id}</h3>
                <label for="rj-modal" class="close-button" onclick="closeEditModal()">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAdVBMVEUAAABNTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU0N3NIOAAAAJnRSTlMAAQIDBAUGBwgRFRYZGiEjQ3l7hYaqtLm8vsDFx87a4uvv8fP1+bbY9ZEAAAB8SURBVBhXXY5LFoJAAMOCIP4VBRXEv5j7H9HFDOizu2TRFljedgCQHeocWHVaAWStXnKyl2oVWI+kd1XLvFV1D7Ng3qrWKYMZ+MdEhk3gbhw59KvlH0eTnf2mgiRwvQ7NW6aqNmncukKhnvo/zzlQ2PR/HgsAJkncH6XwAcr0FUY5BVeFAAAAAElFTkSuQmCC" width="16" height="16" alt="&times;">
                </label>
            </div>
            <div class="rj-modal-body">
                <p><strong>Current: </strong> "${content}" </p>
                <input type="text" id="new${editField}" placeholder="New Title">
                <button onclick="quickEdit(${id}, '${content}', '${editField}')" class="rj-modal-btn">Edit</button>
                <button onclick="closeEditModal()" class="rj-modal-btn">Cancel</button>
            </div>
        </div>
    `;
        document.querySelector('.editModalWrap').innerHTML = editModalContent;
    }

    function closeEditModal() {
        document.querySelector('.editModalWrap').innerHTML = "";
    }

    function quickEdit(id, content, editField) {
        const newTitle = document.getElementById('newTitle').value;
        fetch(`q_edit_media.php`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    id,
                    newTitle
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {

                    const titleSpan = document.querySelector('[data-titlespan-id="' + id + '"]');
                    titleSpan.innerHTML = `<span class='q-edit-new-value'>${data.newTitle}</span>`

                    // alert('Title updated successfully');
                } else {
                    alert('Failed to update title');
                }

            });
    }


    function toggle(source) {
        checkboxes = document.getElementsByName('checkBoxArray[]');
        for (var i = 0, n = checkboxes.length;; i++) {
            checkboxes[i].checked = source.checked;
        }
    }


    delMediaModalWrap = document.querySelector('.delMediaModalWrap');

    let delModalMediaContent = `<label for="rj-modal" class="rj-modal-background"></label>
          <div class="rj-modal">
          <div class="rj-modal-header">
          <h3>Confirm deletion</h3>
            <label for="rj-modal">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAdVBMVEUAAABNTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU0N3NIOAAAAJnRSTlMAAQIDBAUGBwgRFRYZGiEjQ3l7hYaqtLm8vsDFx87a4uvv8fP1+bbY9ZEAAAB8SURBVBhXXY5LFoJAAMOCIP4VBRXEv5j7H9HFDOizu2TRFljedgCQHeocWHVaAWStXnKyl2oVWI+kd1XLvFV1D7Ng3qrWKYMZ+MdEhk3gbhw59KvlH0eTnf2mgiRwvQ7NW6aqNmncukKhnvo/zzlQ2PR/HgsAJkncH6XwAcr0FUY5BVeFAAAAAElFTkSuQmCC" width="16" height="16" alt="" onclick="closeDelModal()">
            </label>
            </div>
            <p>
            Delete Media?<br>
            `;


    function deleteMediaModal(id) {
        let media_id = id;
        let link = `<a href="allmedia.php?delete=` + media_id + `" class="rj-modal-btn">Confirm</a><br><a href="allmedia.php" onClick="closeDelMediaModal()" class="rj-modal-btn">Cancel</a> </p></div>`
        document.querySelector(".delMediaModalWrap").innerHTML = delModalMediaContent + link;
    }


    function closeDelMediaModal() {
        delModal.style.display = "none";

    }
</script>y